package com.jbytescanner.model;

import com.jbytescanner.config.SinkRule;
import lombok.Data;
import java.util.List;

@Data
public class Vulnerability {
    private String type;
    private String sourceMethod;
    private String sinkMethod;
    private List<String> trace;
    
    // Phase 8.2 Scoring Fields
    private double score;
    private double confidenceScore; // 0.0 - 1.0
    private String riskLevel; // CRITICAL, HIGH, MEDIUM, LOW, INFO
    private boolean isFullFlow; // True if Source -> Sink is complete
    
    // Link back to rule
    private SinkRule sinkRule;

    public Vulnerability(String type, String sourceMethod, String sinkMethod, List<String> trace, boolean isFullFlow, SinkRule sinkRule) {
        this.type = type;
        this.sourceMethod = sourceMethod;
        this.sinkMethod = sinkMethod;
        this.trace = trace;
        this.isFullFlow = isFullFlow;
        this.sinkRule = sinkRule;
    }
}
