config:
  max_depth: 15
  # Scan packages: List package prefixes to include in the scan.
  # Important: If your business logic resides in dependencies (BOOT-INF/lib),
  # you MUST add their package prefixes here to promote them to Application Classes.
  # Leave empty to scan only the main jar (BOOT-INF/classes).
  scan_packages: 
    # - "com.example"
    # - "org.mycompany"
  auth_config:
    blocking_annotations:
      # - "com.company.security.CheckUser"
    bypass_annotations:
      # - "com.company.security.OpenApi"

sources:
  # Spring MVC
  - type: "annotation"
    value: "org.springframework.web.bind.annotation.RequestParam"
  - type: "annotation"
    value: "org.springframework.web.bind.annotation.PathVariable"
  - type: "annotation"
    value: "org.springframework.web.bind.annotation.RequestBody"
  - type: "annotation"
    value: "org.springframework.web.bind.annotation.RequestHeader"
  - type: "annotation"
    value: "org.springframework.web.bind.annotation.CookieValue"
  # Servlet
  - type: "method"
    signature: "<javax.servlet.http.HttpServletRequest: java.lang.String getParameter(java.lang.String)>"
  - type: "method"
    signature: "<javax.servlet.http.HttpServletRequest: java.lang.String getHeader(java.lang.String)>"
  - type: "method"
    signature: "<javax.servlet.http.HttpServletRequest: java.lang.String getQueryString()>"
  - type: "method"
    signature: "<javax.servlet.http.HttpServletRequest: javax.servlet.http.Cookie[] getCookies()>"

sinks:
  # --- RCE (Command Execution) ---
  # Score: 9.5 (Command Injection)
  - type: "method"
    vuln_type: "RCE"
    category: "cmd-exec"
    signature: "<java.lang.Runtime: java.lang.Process exec(java.lang.String)>"
  - type: "method"
    vuln_type: "RCE"
    category: "cmd-exec"
    signature: "<java.lang.Runtime: java.lang.Process exec(java.lang.String[])>"
  - type: "method"
    vuln_type: "RCE"
    category: "cmd-exec"
    signature: "<java.lang.Runtime: java.lang.Process exec(java.lang.String,java.lang.String[])>"
  - type: "method"
    vuln_type: "RCE"
    category: "cmd-exec"
    signature: "<java.lang.ProcessBuilder: void <init>(java.lang.String[])>"
  - type: "method"
    vuln_type: "RCE"
    category: "cmd-exec"
    signature: "<java.lang.ProcessBuilder: java.lang.ProcessBuilder command(java.lang.String[])>"
  - type: "method"
    vuln_type: "RCE"
    category: "cmd-exec"
    signature: "<java.lang.ProcessBuilder: java.lang.ProcessBuilder command(java.util.List)>"

  # --- Code Injection / Expression Injection ---
  # Score: 10.0 (In-Memory Code Exec)
  
  # Script Engine
  - type: "method"
    vuln_type: "RCE"
    category: "code-exec"
    signature: "<javax.script.ScriptEngine: java.lang.Object eval(java.lang.String)>"
  - type: "method"
    vuln_type: "Script_Engine_Injection"
    category: "code-exec"
    signature: "<groovy.lang.GroovyShell: java.lang.Object evaluate(java.lang.String)>"

  # OGNL/MVEL/SpEL expression evaluation
  - type: "method"
    vuln_type: "RCE"
    category: "code-exec"
    signature: "<ognl.Ognl: java.lang.Object getValue(java.lang.Object,java.lang.Object)>"
  - type: "method"
    vuln_type: "RCE"
    category: "code-exec"
    signature: "<org.springframework.expression.ExpressionParser: org.springframework.expression.Expression parseExpression(java.lang.String)>"
  - type: "method"
    vuln_type: "RCE"
    category: "code-exec"
    signature: "<org.mvel2.MVEL: java.lang.Object eval(java.lang.String)>"

  # --- Deserialization ---
  # Score: 8.5
  
  # Native
  - type: "method"
    vuln_type: "Deserialization"
    category: "deserialization"
    signature: "<java.io.ObjectInputStream: java.lang.Object readObject()>"
  
  # SnakeYAML
  - type: "method"
    vuln_type: "Deserialization"
    category: "deserialization"
    signature: "<org.yaml.snakeyaml.Yaml: java.lang.Object load(java.lang.String)>"
  
  # FastJSON
  - type: "method"
    vuln_type: "Deserialization"
    category: "deserialization"
    signature: "<com.alibaba.fastjson.JSON: java.lang.Object parse(java.lang.String)>"
  - type: "method"
    vuln_type: "Deserialization"
    category: "deserialization"
    signature: "<com.alibaba.fastjson.JSON: java.lang.Object parseObject(java.lang.String)>"
  - type: "method"
    vuln_type: "Deserialization"
    category: "deserialization"
    signature: "<com.alibaba.fastjson.JSON: com.alibaba.fastjson.JSONObject parseObject(java.lang.String)>"
  
  # Jackson
  - type: "method"
    vuln_type: "Deserialization"
    category: "deserialization"
    signature: "<com.fasterxml.jackson.databind.ObjectMapper: java.lang.Object readValue(java.lang.String,java.lang.Class)>"

  # --- SQL Injection ---
  # Score: 8.0
  - type: "method"
    vuln_type: "SQL_Injection"
    category: "sqli"
    signature: "<java.sql.Statement: java.sql.ResultSet executeQuery(java.lang.String)>"
  - type: "method"
    vuln_type: "SQL_Injection"
    category: "sqli"
    signature: "<java.sql.Statement: int executeUpdate(java.lang.String)>"
  - type: "method"
    vuln_type: "SQL_Injection"
    category: "sqli"
    signature: "<java.sql.Statement: boolean execute(java.lang.String)>"
  - type: "method"
    vuln_type: "SQL_Injection"
    category: "sqli"
    signature: "<org.springframework.jdbc.core.JdbcTemplate: void execute(java.lang.String)>"
  - type: "method"
    vuln_type: "SQL_Injection"
    category: "sqli"
    signature: "<org.springframework.jdbc.core.JdbcTemplate: java.util.List query(java.lang.String,org.springframework.jdbc.core.RowMapper)>"

  # --- SSRF ---
  # Score: 7.5
  - type: "method"
    vuln_type: "SSRF"
    category: "ssrf"
    signature: "<java.net.URL: java.io.InputStream openStream()>"
  - type: "method"
    vuln_type: "SSRF"
    category: "ssrf"
    signature: "<java.net.URL: java.net.URLConnection openConnection()>"
  - type: "method"
    vuln_type: "SSRF"
    category: "ssrf"
    signature: "<java.net.URL: void <init>(java.lang.String)>"
  - type: "method"
    vuln_type: "SSRF"
    category: "ssrf"
    signature: "<java.net.URI: void <init>(java.lang.String)>"
  - type: "method"
    vuln_type: "SSRF"
    category: "ssrf"
    signature: "<org.apache.http.impl.client.CloseableHttpClient: org.apache.http.client.methods.CloseableHttpResponse execute(org.apache.http.client.methods.HttpUriRequest)>"

  # --- Path Traversal / File Access ---
  # Score: 6.0
  - type: "method"
    vuln_type: "Path_Traversal"
    category: "path_traversal"
    signature: "<java.io.FileInputStream: void <init>(java.lang.String)>"
  - type: "method"
    vuln_type: "Path_Traversal"
    category: "path_traversal"
    signature: "<java.io.FileInputStream: void <init>(java.io.File)>"
  - type: "method"
    vuln_type: "Path_Traversal"
    category: "path_traversal"
    signature: "<java.io.FileOutputStream: void <init>(java.lang.String)>"
  - type: "method"
    vuln_type: "Path_Traversal"
    category: "path_traversal"
    signature: "<java.io.File: void <init>(java.lang.String)>"
  - type: "method"
    vuln_type: "Path_Traversal"
    category: "path_traversal"
    signature: "<java.nio.file.Paths: java.nio.file.Path get(java.lang.String,java.lang.String[])>"
  - type: "method"
    vuln_type: "Path_Traversal"
    category: "path_traversal"
    signature: "<java.nio.file.Files: java.nio.file.Path write(java.nio.file.Path,byte[],java.nio.file.OpenOption[])>"

  # --- XXE ---
  # Score: 6.0
  - type: "method"
    vuln_type: "XXE"
    category: "xxe"
    signature: "<javax.xml.parsers.DocumentBuilder: org.w3c.dom.Document parse(java.io.InputStream)>"
  - type: "method"
    vuln_type: "XXE"
    category: "xxe"
    signature: "<org.xml.sax.XMLReader: void parse(org.xml.sax.InputSource)>"

  # --- XSS ---
  # Score: 4.0
  - type: "method"
    vuln_type: "XSS"
    category: "xss"
    signature: "<javax.servlet.http.HttpServletResponse: java.io.PrintWriter getWriter()>"

  # --- Open Redirect ---
  # Score: 4.0 (Default Low/Medium)
  - type: "method"
    vuln_type: "Open_Redirect"
    category: "redirect"
    signature: "<javax.servlet.http.HttpServletResponse: void sendRedirect(java.lang.String)>"

  # --- Log Injection ---
  # Score: 2.0 (Info)
  - type: "method"
    vuln_type: "Log_Injection"
    category: "log-injection"
    signature: "<org.slf4j.Logger: void info(java.lang.String)>"
