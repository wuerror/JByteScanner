config:
  max_depth: 15
  # Scan packages: List package prefixes to include in the scan.
  # Important: If your business logic resides in dependencies (BOOT-INF/lib),
  # you MUST add their package prefixes here to promote them to Application Classes.
  # Leave empty to scan only the main jar (BOOT-INF/classes).
  scan_packages: 
    # - "com.example"
    # - "org.mycompany"

sources:
  # Spring MVC
  - type: "annotation"
    value: "org.springframework.web.bind.annotation.RequestParam"
  - type: "annotation"
    value: "org.springframework.web.bind.annotation.PathVariable"
  - type: "annotation"
    value: "org.springframework.web.bind.annotation.RequestBody"
  - type: "annotation"
    value: "org.springframework.web.bind.annotation.RequestHeader"
  - type: "annotation"
    value: "org.springframework.web.bind.annotation.CookieValue"
  # Servlet
  - type: "method"
    signature: "<javax.servlet.http.HttpServletRequest: java.lang.String getParameter(java.lang.String)>"
  - type: "method"
    signature: "<javax.servlet.http.HttpServletRequest: java.lang.String getHeader(java.lang.String)>"
  - type: "method"
    signature: "<javax.servlet.http.HttpServletRequest: java.lang.String getQueryString()>"
  - type: "method"
    signature: "<javax.servlet.http.HttpServletRequest: javax.servlet.http.Cookie[] getCookies()>"

sinks:
  # --- RCE ---
  - type: "method"
    vuln_type: "RCE"
    signature: "<java.lang.Runtime: java.lang.Process exec(java.lang.String)>"
  - type: "method"
    vuln_type: "RCE"
    signature: "<java.lang.Runtime: java.lang.Process exec(java.lang.String[])>"
  - type: "method"
    vuln_type: "RCE"
    signature: "<java.lang.Runtime: java.lang.Process exec(java.lang.String,java.lang.String[])>"
  - type: "method"
    vuln_type: "RCE"
    signature: "<java.lang.ProcessBuilder: void <init>(java.lang.String[])>"
  - type: "method"
    vuln_type: "RCE"
    signature: "<java.lang.ProcessBuilder: java.lang.ProcessBuilder command(java.lang.String[])>"
  - type: "method"
    vuln_type: "RCE"
    signature: "<java.lang.ProcessBuilder: java.lang.ProcessBuilder command(java.util.List)>"
  # OGNL/MVEL/SpEL expression evaluation
  - type: "method"
    vuln_type: "RCE"
    signature: "<ognl.Ognl: java.lang.Object getValue(java.lang.Object,java.lang.Object)>"
  - type: "method"
    vuln_type: "RCE"
    signature: "<org.springframework.expression.ExpressionParser: org.springframework.expression.Expression parseExpression(java.lang.String)>"
  - type: "method"
    vuln_type: "RCE"
    signature: "<org.mvel2.MVEL: java.lang.Object eval(java.lang.String)>"
  # Script Engine
  - type: "method"
    vuln_type: "RCE"
    signature: "<javax.script.ScriptEngine: java.lang.Object eval(java.lang.String)>"

  # --- JDBC Connection RCE ---
  - type: "method"
    vuln_type: "JDBC_RCE"
    signature: "<java.sql.DriverManager: java.sql.Connection getConnection(java.lang.String)>"
  - type: "method"
    vuln_type: "JDBC_RCE"
    signature: "<java.sql.DriverManager: java.sql.Connection getConnection(java.lang.String,java.util.Properties)>"
  - type: "method"
    vuln_type: "JDBC_RCE"
    signature: "<java.sql.DriverManager: java.sql.Connection getConnection(java.lang.String,java.lang.String,java.lang.String)>"
  - type: "method"
    vuln_type: "JDBC_RCE"
    signature: "<javax.sql.DataSource: java.sql.Connection getConnection()>"
  - type: "method"
    vuln_type: "JDBC_RCE"
    signature: "<com.zaxxer.hikari.HikariDataSource: void setJdbcUrl(java.lang.String)>"
  - type: "method"
    vuln_type: "JDBC_RCE"
    signature: "<org.apache.commons.dbcp2.BasicDataSource: void setUrl(java.lang.String)>"

  # --- SQL Injection ---
  # JDBC
  - type: "method"
    vuln_type: "SQL_Injection"
    signature: "<java.sql.Statement: java.sql.ResultSet executeQuery(java.lang.String)>"
  - type: "method"
    vuln_type: "SQL_Injection"
    signature: "<java.sql.Statement: int executeUpdate(java.lang.String)>"
  - type: "method"
    vuln_type: "SQL_Injection"
    signature: "<java.sql.Statement: boolean execute(java.lang.String)>"
  - type: "method"
    vuln_type: "SQL_Injection"
    signature: "<java.sql.Connection: java.sql.Statement createStatement()>"
  
  # JDBC Template
  - type: "method"
    vuln_type: "SQL_Injection"
    signature: "<org.springframework.jdbc.core.JdbcTemplate: void execute(java.lang.String)>"
  - type: "method"
    vuln_type: "SQL_Injection"
    signature: "<org.springframework.jdbc.core.JdbcTemplate: java.util.List query(java.lang.String,org.springframework.jdbc.core.RowMapper)>"
  - type: "method"
    vuln_type: "SQL_Injection"
    signature: "<org.springframework.jdbc.core.JdbcTemplate: int update(java.lang.String)>"
  - type: "method"
    vuln_type: "SQL_Injection"
    signature: "<org.springframework.jdbc.core.JdbcTemplate: java.util.Map queryForMap(java.lang.String)>"
  - type: "method"
    vuln_type: "SQL_Injection"
    signature: "<org.springframework.jdbc.core.JdbcTemplate: java.lang.Object queryForObject(java.lang.String,java.lang.Class)>"

  # MyBatis-Plus - 危险方法
  - type: "method"
    vuln_type: "SQL_Injection"
    signature: "<com.baomidou.mybatisplus.core.conditions.query.QueryWrapper: com.baomidou.mybatisplus.core.conditions.query.QueryWrapper apply(java.lang.String,java.lang.Object[])>"
  - type: "method"
    vuln_type: "SQL_Injection"
    signature: "<com.baomidou.mybatisplus.core.conditions.query.QueryWrapper: com.baomidou.mybatisplus.core.conditions.query.QueryWrapper last(java.lang.String)>"
  - type: "method"
    vuln_type: "SQL_Injection"
    signature: "<com.baomidou.mybatisplus.core.conditions.update.UpdateWrapper: com.baomidou.mybatisplus.core.conditions.update.UpdateWrapper setSql(java.lang.String)>"
  - type: "method"
    vuln_type: "SQL_Injection"
    signature: "<com.baomidou.mybatisplus.core.conditions.query.LambdaQueryWrapper: com.baomidou.mybatisplus.core.conditions.query.LambdaQueryWrapper apply(java.lang.String,java.lang.Object[])>"
  - type: "method"
    vuln_type: "SQL_Injection"
    signature: "<com.baomidou.mybatisplus.core.conditions.query.LambdaQueryWrapper: com.baomidou.mybatisplus.core.conditions.query.LambdaQueryWrapper last(java.lang.String)>"
  - type: "method"
    vuln_type: "SQL_Injection"
    signature: "<com.baomidou.mybatisplus.extension.conditions.query.QueryChainWrapper: com.baomidou.mybatisplus.extension.conditions.query.QueryChainWrapper last(java.lang.String)>"
  # 注意: inSql虽然危险但如果参数化使用则安全,建议标注为warning级别
  - type: "method"
    vuln_type: "SQL_Injection"
    signature: "<com.baomidou.mybatisplus.core.conditions.query.QueryWrapper: com.baomidou.mybatisplus.core.conditions.query.QueryWrapper inSql(java.lang.String,java.lang.String)>"
  - type: "method"
    vuln_type: "SQL_Injection"
    signature: "<com.baomidou.mybatisplus.core.conditions.query.QueryWrapper: com.baomidou.mybatisplus.core.conditions.query.QueryWrapper notInSql(java.lang.String,java.lang.String)>"
  - type: "method"
    vuln_type: "SQL_Injection"
    signature: "<com.baomidou.mybatisplus.core.conditions.query.QueryWrapper: com.baomidou.mybatisplus.core.conditions.query.QueryWrapper exists(java.lang.String)>"
  - type: "method"
    vuln_type: "SQL_Injection"
    signature: "<com.baomidou.mybatisplus.core.conditions.query.QueryWrapper: com.baomidou.mybatisplus.core.conditions.query.QueryWrapper notExists(java.lang.String)>"

  # Hibernate HQL Injection
  - type: "method"
    vuln_type: "SQL_Injection"
    signature: "<org.hibernate.Session: org.hibernate.Query createQuery(java.lang.String)>"
  - type: "method"
    vuln_type: "SQL_Injection"
    signature: "<org.hibernate.Session: org.hibernate.SQLQuery createSQLQuery(java.lang.String)>"
  - type: "method"
    vuln_type: "SQL_Injection"
    signature: "<javax.persistence.EntityManager: javax.persistence.Query createQuery(java.lang.String)>"
  - type: "method"
    vuln_type: "SQL_Injection"
    signature: "<javax.persistence.EntityManager: javax.persistence.Query createNativeQuery(java.lang.String)>"

  # --- Deserialization ---
  # Native
  - type: "method"
    vuln_type: "Deserialization"
    signature: "<java.io.ObjectInputStream: java.lang.Object readObject()>"
  - type: "method"
    vuln_type: "Deserialization"
    signature: "<java.io.ObjectInputStream: java.lang.Object readUnshared()>"
  
  # SnakeYAML
  - type: "method"
    vuln_type: "Deserialization"
    signature: "<org.yaml.snakeyaml.Yaml: java.lang.Object load(java.lang.String)>"
  - type: "method"
    vuln_type: "Deserialization"
    signature: "<org.yaml.snakeyaml.Yaml: java.lang.Object load(java.io.InputStream)>"
  - type: "method"
    vuln_type: "Deserialization"
    signature: "<org.yaml.snakeyaml.Yaml: java.lang.Object loadAll(java.lang.String)>"
  
  # XStream
  - type: "method"
    vuln_type: "Deserialization"
    signature: "<com.thoughtworks.xstream.XStream: java.lang.Object fromXML(java.lang.String)>"
  - type: "method"
    vuln_type: "Deserialization"
    signature: "<com.thoughtworks.xstream.XStream: java.lang.Object fromXML(java.io.InputStream)>"
  
  # FastJSON
  - type: "method"
    vuln_type: "Deserialization"
    signature: "<com.alibaba.fastjson.JSON: java.lang.Object parse(java.lang.String)>"
  - type: "method"
    vuln_type: "Deserialization"
    signature: "<com.alibaba.fastjson.JSON: java.lang.Object parseObject(java.lang.String)>"
  - type: "method"
    vuln_type: "Deserialization"
    signature: "<com.alibaba.fastjson.JSON: com.alibaba.fastjson.JSONObject parseObject(java.lang.String)>"
  - type: "method"
    vuln_type: "Deserialization"
    signature: "<com.alibaba.fastjson2.JSON: java.lang.Object parseObject(java.lang.String)>"
  
  # Jackson
  - type: "method"
    vuln_type: "Deserialization"
    signature: "<com.fasterxml.jackson.databind.ObjectMapper: java.lang.Object readValue(java.lang.String,java.lang.Class)>"
  - type: "method"
    vuln_type: "Deserialization"
    signature: "<com.fasterxml.jackson.databind.ObjectMapper: java.lang.Object readValue(java.io.InputStream,java.lang.Class)>"
  
  # Hessian
  - type: "method"
    vuln_type: "Deserialization"
    signature: "<com.caucho.hessian.io.HessianInput: java.lang.Object readObject()>"
  
  # XMLDecoder
  - type: "method"
    vuln_type: "Deserialization"
    signature: "<java.beans.XMLDecoder: java.lang.Object readObject()>"

  # --- SSRF ---
  - type: "method"
    vuln_type: "SSRF"
    signature: "<java.net.URL: java.io.InputStream openStream()>"
  - type: "method"
    vuln_type: "SSRF"
    signature: "<java.net.URL: java.net.URLConnection openConnection()>"
  - type: "method"
    vuln_type: "SSRF"
    signature: "<java.net.URL: void <init>(java.lang.String)>"
  - type: "method"
    vuln_type: "SSRF"
    signature: "<java.net.URI: void <init>(java.lang.String)>"
  
  # Apache HttpClient
  - type: "method"
    vuln_type: "SSRF"
    signature: "<org.apache.http.impl.client.CloseableHttpClient: org.apache.http.client.methods.CloseableHttpResponse execute(org.apache.http.client.methods.HttpUriRequest)>"
  - type: "method"
    vuln_type: "SSRF"
    signature: "<org.apache.http.client.HttpClient: org.apache.http.HttpResponse execute(org.apache.http.client.methods.HttpUriRequest)>"
  
  # OkHttp
  - type: "method"
    vuln_type: "SSRF"
    signature: "<okhttp3.OkHttpClient: okhttp3.Call newCall(okhttp3.Request)>"
  - type: "method"
    vuln_type: "SSRF"
    signature: "<okhttp3.Request$Builder: okhttp3.Request$Builder url(java.lang.String)>"
  
  # RestTemplate
  - type: "method"
    vuln_type: "SSRF"
    signature: "<org.springframework.web.client.RestTemplate: java.lang.Object getForObject(java.lang.String,java.lang.Class,java.lang.Object[])>"
  - type: "method"
    vuln_type: "SSRF"
    signature: "<org.springframework.web.client.RestTemplate: org.springframework.http.ResponseEntity getForEntity(java.lang.String,java.lang.Class,java.lang.Object[])>"
  - type: "method"
    vuln_type: "SSRF"
    signature: "<org.springframework.web.client.RestTemplate: java.lang.Object postForObject(java.lang.String,java.lang.Object,java.lang.Class,java.lang.Object[])>"
  
  # URLConnection
  - type: "method"
    vuln_type: "SSRF"
    signature: "<java.net.HttpURLConnection: void <init>(java.net.URL)>"
  - type: "method"
    vuln_type: "SSRF"
    signature: "<java.net.URLConnection: java.io.InputStream getInputStream()>"

  # --- Path Traversal / File Access ---
  - type: "method"
    vuln_type: "Path_Traversal"
    signature: "<java.io.FileInputStream: void <init>(java.lang.String)>"
  - type: "method"
    vuln_type: "Path_Traversal"
    signature: "<java.io.FileInputStream: void <init>(java.io.File)>"
  - type: "method"
    vuln_type: "Path_Traversal"
    signature: "<java.io.FileOutputStream: void <init>(java.lang.String)>"
  - type: "method"
    vuln_type: "Path_Traversal"
    signature: "<java.io.FileOutputStream: void <init>(java.io.File)>"
  - type: "method"
    vuln_type: "Path_Traversal"
    signature: "<java.io.RandomAccessFile: void <init>(java.lang.String,java.lang.String)>"
  - type: "method"
    vuln_type: "Path_Traversal"
    signature: "<java.io.File: void <init>(java.lang.String)>"
  - type: "method"
    vuln_type: "Path_Traversal"
    signature: "<java.nio.file.Paths: java.nio.file.Path get(java.lang.String,java.lang.String[])>"
  - type: "method"
    vuln_type: "Path_Traversal"
    signature: "<java.nio.file.Files: byte[] readAllBytes(java.nio.file.Path)>"
  - type: "method"
    vuln_type: "Path_Traversal"
    signature: "<java.nio.file.Files: java.util.List readAllLines(java.nio.file.Path)>"
  - type: "method"
    vuln_type: "Path_Traversal"
    signature: "<java.nio.file.Files: java.nio.file.Path write(java.nio.file.Path,byte[],java.nio.file.OpenOption[])>"
  # Apache Commons IO
  - type: "method"
    vuln_type: "Path_Traversal"
    signature: "<org.apache.commons.io.FileUtils: java.lang.String readFileToString(java.io.File)>"
  - type: "method"
    vuln_type: "Path_Traversal"
    signature: "<org.apache.commons.io.FileUtils: void writeStringToFile(java.io.File,java.lang.String)>"

  # --- XXE (XML External Entity) ---
  - type: "method"
    vuln_type: "XXE"
    signature: "<javax.xml.parsers.DocumentBuilder: org.w3c.dom.Document parse(java.io.InputStream)>"
  - type: "method"
    vuln_type: "XXE"
    signature: "<javax.xml.parsers.DocumentBuilder: org.w3c.dom.Document parse(java.lang.String)>"
  - type: "method"
    vuln_type: "XXE"
    signature: "<javax.xml.parsers.SAXParser: void parse(java.io.InputStream,org.xml.sax.helpers.DefaultHandler)>"
  - type: "method"
    vuln_type: "XXE"
    signature: "<org.xml.sax.XMLReader: void parse(org.xml.sax.InputSource)>"
  - type: "method"
    vuln_type: "XXE"
    signature: "<javax.xml.transform.TransformerFactory: javax.xml.transform.Transformer newTransformer(javax.xml.transform.Source)>"
  - type: "method"
    vuln_type: "XXE"
    signature: "<javax.xml.validation.Validator: void validate(javax.xml.transform.Source)>"

  # --- XSS (Server-side rendering) ---
  - type: "method"
    vuln_type: "XSS"
    signature: "<javax.servlet.http.HttpServletResponse: java.io.PrintWriter getWriter()>"
  - type: "method"
    vuln_type: "XSS"
    signature: "<javax.servlet.ServletOutputStream: void print(java.lang.String)>"
  - type: "method"
    vuln_type: "XSS"
    signature: "<javax.servlet.ServletOutputStream: void println(java.lang.String)>"

  # --- Template Injection ---
  # Velocity
  - type: "method"
    vuln_type: "Template_Injection"
    signature: "<org.apache.velocity.app.Velocity: boolean evaluate(org.apache.velocity.context.Context,java.io.Writer,java.lang.String,java.lang.String)>"
  # Freemarker
  - type: "method"
    vuln_type: "Template_Injection"
    signature: "<freemarker.template.Template: void process(java.lang.Object,java.io.Writer)>"
  - type: "method"
    vuln_type: "Template_Injection"
    signature: "<freemarker.template.Configuration: freemarker.template.Template getTemplate(java.lang.String)>"
  # Thymeleaf
  - type: "method"
    vuln_type: "Template_Injection"
    signature: "<org.thymeleaf.TemplateEngine: java.lang.String process(java.lang.String,org.thymeleaf.context.IContext)>"

  # --- LDAP Injection ---
  - type: "method"
    vuln_type: "LDAP_Injection"
    signature: "<javax.naming.directory.DirContext: javax.naming.NamingEnumeration search(java.lang.String,java.lang.String,javax.naming.directory.SearchControls)>"
  - type: "method"
    vuln_type: "LDAP_Injection"
    signature: "<javax.naming.directory.InitialDirContext: javax.naming.NamingEnumeration search(javax.naming.Name,java.lang.String,javax.naming.directory.SearchControls)>"

  # --- Zip Slip ---
  - type: "method"
    vuln_type: "Zip_Slip"
    signature: "<java.util.zip.ZipEntry: java.lang.String getName()>"
  - type: "method"
    vuln_type: "Zip_Slip"
    signature: "<java.util.jar.JarEntry: java.lang.String getName()>"

  # --- Redirect ---
  - type: "method"
    vuln_type: "Open_Redirect"
    signature: "<javax.servlet.http.HttpServletResponse: void sendRedirect(java.lang.String)>"
  - type: "method"
    vuln_type: "Open_Redirect"
    signature: "<org.springframework.web.servlet.view.RedirectView: void <init>(java.lang.String)>"

  # --- Log Injection ---
  - type: "method"
    vuln_type: "Log_Injection"
    signature: "<org.slf4j.Logger: void info(java.lang.String)>"
  - type: "method"
    vuln_type: "Log_Injection"
    signature: "<org.slf4j.Logger: void error(java.lang.String)>"
  - type: "method"
    vuln_type: "Log_Injection"
    signature: "<org.slf4j.Logger: void warn(java.lang.String)>"
  - type: "method"
    vuln_type: "Log_Injection"
    signature: "<org.slf4j.Logger: void debug(java.lang.String)>"
  - type: "method"
    vuln_type: "Log_Injection"
    signature: "<java.util.logging.Logger: void info(java.lang.String)>"
  - type: "method"
    vuln_type: "Log_Injection"
    signature: "<org.apache.logging.log4j.Logger: void info(java.lang.String)>"
# --- Template Injection (SSTI) ---
  
  # Velocity
  - type: "method"
    vuln_type: "Template_Injection"
    signature: "<org.apache.velocity.app.Velocity: boolean evaluate(org.apache.velocity.context.Context,java.io.Writer,java.lang.String,java.lang.String)>"
  - type: "method"
    vuln_type: "Template_Injection"
    signature: "<org.apache.velocity.app.VelocityEngine: boolean evaluate(org.apache.velocity.context.Context,java.io.Writer,java.lang.String,java.lang.String)>"
  - type: "method"
    vuln_type: "Template_Injection"
    signature: "<org.apache.velocity.Template: void merge(org.apache.velocity.context.Context,java.io.Writer)>"
  - type: "method"
    vuln_type: "Template_Injection"
    signature: "<org.apache.velocity.app.VelocityEngine: org.apache.velocity.Template getTemplate(java.lang.String)>"
  - type: "method"
    vuln_type: "Template_Injection"
    signature: "<org.apache.velocity.runtime.RuntimeInstance: boolean evaluate(org.apache.velocity.context.Context,java.io.Writer,java.lang.String,java.lang.String)>"

  # Freemarker
  - type: "method"
    vuln_type: "Template_Injection"
    signature: "<freemarker.template.Template: void process(java.lang.Object,java.io.Writer)>"
  - type: "method"
    vuln_type: "Template_Injection"
    signature: "<freemarker.template.Configuration: freemarker.template.Template getTemplate(java.lang.String)>"
  - type: "method"
    vuln_type: "Template_Injection"
    signature: "<freemarker.template.Template: void <init>(java.lang.String,java.lang.String,freemarker.template.Configuration)>"
  - type: "method"
    vuln_type: "Template_Injection"
    signature: "<freemarker.cache.TemplateCache: freemarker.template.Template getTemplate(java.lang.String,java.util.Locale,java.lang.Object,java.lang.String,boolean)>"

  # Thymeleaf
  - type: "method"
    vuln_type: "Template_Injection"
    signature: "<org.thymeleaf.TemplateEngine: java.lang.String process(java.lang.String,org.thymeleaf.context.IContext)>"
  - type: "method"
    vuln_type: "Template_Injection"
    signature: "<org.thymeleaf.TemplateEngine: void process(java.lang.String,org.thymeleaf.context.IContext,java.io.Writer)>"
  - type: "method"
    vuln_type: "Template_Injection"
    signature: "<org.thymeleaf.spring5.SpringTemplateEngine: java.lang.String process(java.lang.String,org.thymeleaf.context.IContext)>"
  # Thymeleaf inline expressions
  - type: "method"
    vuln_type: "Template_Injection"
    signature: "<org.thymeleaf.standard.expression.StandardExpressionParser: org.thymeleaf.standard.expression.IStandardExpression parseExpression(org.thymeleaf.context.ITemplateContext,java.lang.String)>"

  # Pebble
  - type: "method"
    vuln_type: "Template_Injection"
    signature: "<com.mitchellbosecke.pebble.PebbleEngine: com.mitchellbosecke.pebble.template.PebbleTemplate getTemplate(java.lang.String)>"
  - type: "method"
    vuln_type: "Template_Injection"
    signature: "<com.mitchellbosecke.pebble.template.PebbleTemplate: void evaluate(java.io.Writer)>"
  - type: "method"
    vuln_type: "Template_Injection"
    signature: "<com.mitchellbosecke.pebble.template.PebbleTemplate: void evaluate(java.io.Writer,java.util.Map)>"

  # Jinja (Jinjava - Java implementation)
  - type: "method"
    vuln_type: "Template_Injection"
    signature: "<com.hubspot.jinjava.Jinjava: java.lang.String render(java.lang.String,java.util.Map)>"
  - type: "method"
    vuln_type: "Template_Injection"
    signature: "<com.hubspot.jinjava.JinjavaEngine: java.lang.String render(java.lang.String,java.util.Map)>"

  # Groovy Template Engine
  - type: "method"
    vuln_type: "Template_Injection"
    signature: "<groovy.text.SimpleTemplateEngine: groovy.text.Template createTemplate(java.lang.String)>"
  - type: "method"
    vuln_type: "Template_Injection"
    signature: "<groovy.text.GStringTemplateEngine: groovy.text.Template createTemplate(java.lang.String)>"
  - type: "method"
    vuln_type: "Template_Injection"
    signature: "<groovy.text.XmlTemplateEngine: groovy.text.Template createTemplate(java.lang.String)>"
  - type: "method"
    vuln_type: "Template_Injection"
    signature: "<groovy.text.StreamingTemplateEngine: groovy.text.Template createTemplate(java.lang.String)>"
  - type: "method"
    vuln_type: "Template_Injection"
    signature: "<groovy.text.Template: java.io.Writer make(java.util.Map)>"

  # Mustache
  - type: "method"
    vuln_type: "Template_Injection"
    signature: "<com.github.mustachejava.Mustache: void execute(java.io.Writer,java.lang.Object)>"
  - type: "method"
    vuln_type: "Template_Injection"
    signature: "<com.github.mustachejava.MustacheFactory: com.github.mustachejava.Mustache compile(java.lang.String)>"

  # Handlebars
  - type: "method"
    vuln_type: "Template_Injection"
    signature: "<com.github.jknack.handlebars.Handlebars: com.github.jknack.handlebars.Template compileInline(java.lang.String)>"
  - type: "method"
    vuln_type: "Template_Injection"
    signature: "<com.github.jknack.handlebars.Template: java.lang.String apply(java.lang.Object)>"

  # JSP Dynamic Compilation
  - type: "method"
    vuln_type: "Template_Injection"
    signature: "<org.apache.jasper.JspCompilationContext: void compile()>"

  # --- JavaScript Engine Injection (ScriptEngine) ---
  
  # Generic ScriptEngine
  - type: "method"
    vuln_type: "Script_Engine_Injection"
    signature: "<javax.script.ScriptEngine: java.lang.Object eval(java.lang.String)>"
  - type: "method"
    vuln_type: "Script_Engine_Injection"
    signature: "<javax.script.ScriptEngine: java.lang.Object eval(java.io.Reader)>"
  - type: "method"
    vuln_type: "Script_Engine_Injection"
    signature: "<javax.script.ScriptEngine: java.lang.Object eval(java.lang.String,javax.script.ScriptContext)>"
  - type: "method"
    vuln_type: "Script_Engine_Injection"
    signature: "<javax.script.ScriptEngine: java.lang.Object eval(java.io.Reader,javax.script.ScriptContext)>"
  - type: "method"
    vuln_type: "Script_Engine_Injection"
    signature: "<javax.script.ScriptEngine: java.lang.Object eval(java.lang.String,javax.script.Bindings)>"
  - type: "method"
    vuln_type: "Script_Engine_Injection"
    signature: "<javax.script.ScriptEngine: java.lang.Object eval(java.io.Reader,javax.script.Bindings)>"

  # Compilable Scripts
  - type: "method"
    vuln_type: "Script_Engine_Injection"
    signature: "<javax.script.Compilable: javax.script.CompiledScript compile(java.lang.String)>"
  - type: "method"
    vuln_type: "Script_Engine_Injection"
    signature: "<javax.script.Compilable: javax.script.CompiledScript compile(java.io.Reader)>"
  - type: "method"
    vuln_type: "Script_Engine_Injection"
    signature: "<javax.script.CompiledScript: java.lang.Object eval()>"
  - type: "method"
    vuln_type: "Script_Engine_Injection"
    signature: "<javax.script.CompiledScript: java.lang.Object eval(javax.script.ScriptContext)>"
  - type: "method"
    vuln_type: "Script_Engine_Injection"
    signature: "<javax.script.CompiledScript: java.lang.Object eval(javax.script.Bindings)>"

  # Invocable interface
  - type: "method"
    vuln_type: "Script_Engine_Injection"
    signature: "<javax.script.Invocable: java.lang.Object invokeFunction(java.lang.String,java.lang.Object[])>"
  - type: "method"
    vuln_type: "Script_Engine_Injection"
    signature: "<javax.script.Invocable: java.lang.Object invokeMethod(java.lang.Object,java.lang.String,java.lang.Object[])>"

  # Nashorn (JavaScript engine for Java 8-14)
  - type: "method"
    vuln_type: "Script_Engine_Injection"
    signature: "<jdk.nashorn.api.scripting.NashornScriptEngine: java.lang.Object eval(java.lang.String)>"
  - type: "method"
    vuln_type: "Script_Engine_Injection"
    signature: "<jdk.nashorn.api.scripting.NashornScriptEngine: java.lang.Object eval(java.io.Reader)>"
  - type: "method"
    vuln_type: "Script_Engine_Injection"
    signature: "<jdk.nashorn.api.scripting.NashornScriptEngineFactory: javax.script.ScriptEngine getScriptEngine()>"

  # GraalVM JavaScript
  - type: "method"
    vuln_type: "Script_Engine_Injection"
    signature: "<org.graalvm.polyglot.Context: org.graalvm.polyglot.Value eval(java.lang.String,java.lang.CharSequence)>"
  - type: "method"
    vuln_type: "Script_Engine_Injection"
    signature: "<org.graalvm.polyglot.Context: org.graalvm.polyglot.Value eval(org.graalvm.polyglot.Source)>"
  - type: "method"
    vuln_type: "Script_Engine_Injection"
    signature: "<org.graalvm.polyglot.Source: org.graalvm.polyglot.Source create(java.lang.String,java.lang.CharSequence)>"

  # Rhino (Mozilla JavaScript engine)
  - type: "method"
    vuln_type: "Script_Engine_Injection"
    signature: "<org.mozilla.javascript.Context: java.lang.Object evaluateString(org.mozilla.javascript.Scriptable,java.lang.String,java.lang.String,int,java.lang.Object)>"
  - type: "method"
    vuln_type: "Script_Engine_Injection"
    signature: "<org.mozilla.javascript.Context: org.mozilla.javascript.Script compileString(java.lang.String,java.lang.String,int,java.lang.Object)>"
  - type: "method"
    vuln_type: "Script_Engine_Injection"
    signature: "<org.mozilla.javascript.Script: java.lang.Object exec(org.mozilla.javascript.Context,org.mozilla.javascript.Scriptable)>"

  # Groovy Script Engine
  - type: "method"
    vuln_type: "Script_Engine_Injection"
    signature: "<groovy.lang.GroovyShell: java.lang.Object evaluate(java.lang.String)>"
  - type: "method"
    vuln_type: "Script_Engine_Injection"
    signature: "<groovy.lang.GroovyShell: java.lang.Object evaluate(java.io.File)>"
  - type: "method"
    vuln_type: "Script_Engine_Injection"
    signature: "<groovy.lang.GroovyShell: groovy.lang.Script parse(java.lang.String)>"
  - type: "method"
    vuln_type: "Script_Engine_Injection"
    signature: "<groovy.lang.GroovyClassLoader: java.lang.Class parseClass(java.lang.String)>"
  - type: "method"
    vuln_type: "Script_Engine_Injection"
    signature: "<groovy.util.GroovyScriptEngine: groovy.lang.Script createScript(java.lang.String,groovy.lang.Binding)>"

  # Python (Jython)
  - type: "method"
    vuln_type: "Script_Engine_Injection"
    signature: "<org.python.util.PythonInterpreter: void exec(java.lang.String)>"
  - type: "method"
    vuln_type: "Script_Engine_Injection"
    signature: "<org.python.util.PythonInterpreter: org.python.core.PyObject eval(java.lang.String)>"
  - type: "method"
    vuln_type: "Script_Engine_Injection"
    signature: "<org.python.core.Py: org.python.core.PyObject eval(java.lang.String)>"

  # Ruby (JRuby)
  - type: "method"
    vuln_type: "Script_Engine_Injection"
    signature: "<org.jruby.embed.ScriptingContainer: java.lang.Object runScriptlet(java.lang.String)>"
  - type: "method"
    vuln_type: "Script_Engine_Injection"
    signature: "<org.jruby.Ruby: org.jruby.runtime.builtin.IRubyObject evalScriptlet(java.lang.String)>"

  # Lua (LuaJ)
  - type: "method"
    vuln_type: "Script_Engine_Injection"
    signature: "<org.luaj.vm2.Globals: org.luaj.vm2.LuaValue load(java.lang.String)>"
  - type: "method"
    vuln_type: "Script_Engine_Injection"
    signature: "<org.luaj.vm2.LuaValue: org.luaj.vm2.LuaValue call(java.lang.String)>"

  # --- Expression Language (EL) Injection ---
  
  # Unified EL (JSP/JSF)
  - type: "method"
    vuln_type: "EL_Injection"
    signature: "<javax.el.ExpressionFactory: javax.el.ValueExpression createValueExpression(javax.el.ELContext,java.lang.String,java.lang.Class)>"
  - type: "method"
    vuln_type: "EL_Injection"
    signature: "<javax.el.ExpressionFactory: javax.el.MethodExpression createMethodExpression(javax.el.ELContext,java.lang.String,java.lang.Class,java.lang.Class[])>"
  - type: "method"
    vuln_type: "EL_Injection"
    signature: "<javax.el.ValueExpression: java.lang.Object getValue(javax.el.ELContext)>"
  - type: "method"
    vuln_type: "EL_Injection"
    signature: "<javax.el.MethodExpression: java.lang.Object invoke(javax.el.ELContext,java.lang.Object[])>"

  # JEXL (Commons JEXL)
  - type: "method"
    vuln_type: "EL_Injection"
    signature: "<org.apache.commons.jexl3.JexlEngine: org.apache.commons.jexl3.JexlScript createScript(java.lang.String)>"
  - type: "method"
    vuln_type: "EL_Injection"
    signature: "<org.apache.commons.jexl3.JexlScript: java.lang.Object execute(org.apache.commons.jexl3.JexlContext)>"
  - type: "method"
    vuln_type: "EL_Injection"
    signature: "<org.apache.commons.jexl2.JexlEngine: org.apache.commons.jexl2.Script createScript(java.lang.String)>"

  # OGNL
  - type: "method"
    vuln_type: "EL_Injection"
    signature: "<ognl.Ognl: java.lang.Object parseExpression(java.lang.String)>"
  - type: "method"
    vuln_type: "EL_Injection"
    signature: "<ognl.Ognl: java.lang.Object getValue(java.lang.Object,java.lang.Object)>"
  - type: "method"
    vuln_type: "EL_Injection"
    signature: "<ognl.Ognl: java.lang.Object getValue(java.lang.String,java.lang.Object)>"
  - type: "method"
    vuln_type: "EL_Injection"
    signature: "<ognl.Ognl: void setValue(java.lang.String,java.lang.Object,java.lang.Object)>"

  # MVEL
  - type: "method"
    vuln_type: "EL_Injection"
    signature: "<org.mvel2.MVEL: java.lang.Object eval(java.lang.String)>"
  - type: "method"
    vuln_type: "EL_Injection"
    signature: "<org.mvel2.MVEL: java.lang.Object eval(java.lang.String,java.lang.Object)>"
  - type: "method"
    vuln_type: "EL_Injection"
    signature: "<org.mvel2.MVEL: java.lang.Object eval(java.lang.String,java.util.Map)>"
  - type: "method"
    vuln_type: "EL_Injection"
    signature: "<org.mvel2.MVEL: java.io.Serializable compileExpression(java.lang.String)>"
  - type: "method"
    vuln_type: "EL_Injection"
    signature: "<org.mvel2.MVEL: java.lang.Object executeExpression(java.lang.Object)>"

  # Spring Expression Language (SpEL)
  - type: "method"
    vuln_type: "EL_Injection"
    signature: "<org.springframework.expression.ExpressionParser: org.springframework.expression.Expression parseExpression(java.lang.String)>"
  - type: "method"
    vuln_type: "EL_Injection"
    signature: "<org.springframework.expression.Expression: java.lang.Object getValue()>"
  - type: "method"
    vuln_type: "EL_Injection"
    signature: "<org.springframework.expression.Expression: java.lang.Object getValue(org.springframework.expression.EvaluationContext)>"
  - type: "method"
    vuln_type: "EL_Injection"
    signature: "<org.springframework.expression.Expression: java.lang.Object getValue(java.lang.Object)>"
  - type: "method"
    vuln_type: "EL_Injection"
    signature: "<org.springframework.expression.spel.standard.SpelExpressionParser: org.springframework.expression.Expression parseExpression(java.lang.String)>"
  - type: "method"
    vuln_type: "EL_Injection"
    signature: "<org.springframework.expression.spel.standard.SpelExpression: java.lang.Object getValue()>"
